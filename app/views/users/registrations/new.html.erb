<h2>Sign up</h2>

<%= simple_form_for(resource, as: resource_name, url: registration_path(resource_name)) do |f| %>
  <%= f.error_notification %>

  <div class="form-inputs">
    <%= f.input :email, required: true, class: "form-control", placeholder: "邮箱", label: false %>
    <%= f.input :login, autofocus: true, class: "form-control input-login", placeholder: "手机号", label: false %>
    <div class="row">
      <div class="col-sm-7">
        <%= f.input :message, wrapper: :inline_form , placeholder: "验证码", label: false %>
      </div>
      <div class="col-sm-5">
        <%= link_to("获取验证码", "javascript:void(0);" , class: "btn btn-info devise-sms-btn", id: "getSmsBtn") %>
      </div>
    </div>
    <%= f.input :password, required: true, hint: ("最短#{@minimum_password_length}个字符！" if @validatable) %>
    <%= f.input :password_confirmation, required: true %>
  </div>
  <div class="form-actions">
    <%= f.button :submit, "注册" %>
  </div>
<% end %>
<%- if controller_name != 'sessions' %>
  <%= link_to "Log in", new_session_path(resource_name) %><br />
<% end -%>

<%- if devise_mapping.registerable? && controller_name != 'registrations' %>
  <%= link_to "Sign up", new_registration_path(resource_name) %><br />
<% end -%>

<script type="text/javascript">
  $(function(){
    $("#getSmsBtn").click(function(){
      var reg = /^(0|86|17951)?(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/;
      if(!$("#user_login").val().match(reg)){
        alert("请输入正确的手机号");
      }else{
        $.ajax({
          type: "POST",
          url: "<%= messages_path %>.js",
          data: "message[Login]=" + $("#user_login").val()
        });
      }
    });
  });
</script>